<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS管理ガイド - マークダウン版</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body {
            background: #f8f9fa;
            padding: 2rem 0;
        }
        .container {
            max-width: 900px;
            background: white;
            padding: 3rem;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        header {
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 2px solid #667eea;
        }
        header h1 {
            color: #667eea;
            margin-bottom: 0.5rem;
        }
        h2 {
            color: #667eea;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e0e0e0;
        }
        h3 {
            color: #764ba2;
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
        }
        h4, h5, h6 {
            color: #555;
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }
        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #d63384;
        }
        pre {
            background: #f5f5f5;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            overflow-x: auto;
        }
        pre code {
            color: #333;
            background: transparent;
            padding: 0;
        }
        table {
            margin: 1.5rem 0;
            border-collapse: collapse;
            width: 100%;
        }
        table th {
            background: #667eea;
            color: white;
            padding: 0.75rem;
            text-align: left;
        }
        table td {
            border: 1px solid #ddd;
            padding: 0.75rem;
        }
        table tr:nth-child(even) {
            background: #f9f9f9;
        }
        .alert {
            margin: 1.5rem 0;
            border-radius: 5px;
        }
        ul, ol {
            margin: 0.5rem 0 0.5rem 1.5rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        strong {
            color: #333;
            font-weight: 600;
        }
        a {
            color: #667eea;
            text-decoration: none;
            border-bottom: 1px solid #667eea;
        }
        a:hover {
            color: #764ba2;
        }
        .toc {
            background: #f0f7ff;
            padding: 1.5rem;
            border-radius: 5px;
            border-left: 4px solid #667eea;
            margin: 2rem 0;
        }
        .toc h5 {
            margin-top: 0;
            color: #667eea;
        }
        .toc ul {
            margin: 0.5rem 0 0 1.5rem;
        }
        .toc a {
            border: none;
        }
        hr {
            margin: 2rem 0;
            border: none;
            border-top: 2px dashed #ddd;
        }
        @media (max-width: 768px) {
            .container {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="d-flex align-items-center justify-content-between mb-3">
                <h1><i class="bi bi-file-text"></i> CMS管理ガイド</h1>
                <a href="/task/admin/index.php" class="btn btn-outline-primary">
                    <i class="bi bi-arrow-left me-2"></i>ダッシュボードに戻る
                </a>
            </div>
            <p class="text-muted mb-0">画像、チェックリスト、モーダルの追加方法と共有・バックアップの最新情報</p>
        </header>

        <div class="toc">
            <h5><i class="bi bi-bookmark me-2"></i>目次</h5>
            <ul>
                <li><a href="#section1">1️⃣ チェックリストを追加する方法</a></li>
                <li><a href="#section2">2️⃣ 画像を追加する方法</a></li>
                <li><a href="#section3">3️⃣ モーダルを追加する方法</a></li>
                <li><a href="#sectionShare">⚡ サイト共有（QRコード）</a></li>
                <li><a href="#section4">🔄 すべてのコンテンツの同期</a></li>
                <li><a href="#section5">📋 よくある質問</a></li>
            </ul>
        </div>

        <h2 id="section1">1️⃣ チェックリストを追加する方法</h2>

        <h3>ステップ1：チェックリスト管理ページへ移動</h3>
        <ol>
            <li>管理画面のサイドメニューから <strong>「チェックリスト」</strong> をクリック</li>
            <li>右上に <strong>「+ 新規追加」</strong> ボタンが表示されます</li>
        </ol>

        <h3>ステップ2：モーダルウィンドウで入力</h3>
        <p><strong>「+ 新規追加」</strong> ボタンをクリックすると、入力フォームが表示されます</p>

        <p><strong>必須項目:</strong></p>
        <ul>
            <li><strong>タイトル</strong> - チェックリストの名前（例：「基本ルール」「事故防止」）</li>
            <li><strong>項目</strong> - チェック項目を1行ずつ入力</li>
        </ul>

        <p><strong>任意項目:</strong></p>
        <ul>
            <li><strong>カテゴリ</strong> - 分類用（例：「出庫前」「運転中」）</li>
        </ul>

        <h3>ステップ3：項目を追加</h3>
        <ol>
            <li>最初の項目を入力欄に書く</li>
            <li><strong>「+ 項目を追加」</strong> ボタンをクリックして、さらに項目を追加</li>
            <li>不要な項目は右側の <strong>削除ボタン(×)</strong> で削除</li>
        </ol>

        <h3>ステップ4：保存</h3>
        <ol>
            <li>下部の <strong>「追加」</strong> ボタンをクリック</li>
            <li>成功メッセージが表示されたら完了</li>
            <li>一覧に新しいチェックリストが表示されます</li>
        </ol>

        <h3>既存チェックリストの編集・削除</h3>
        <ul>
            <li><strong>編集</strong>: 一覧の 鉛筆ボタン をクリック → フォームが開きます</li>
            <li><strong>削除</strong>: 一覧の ゴミ箱ボタン をクリック → 確認後削除</li>
        </ul>

        <hr>

        <h2 id="sectionShare">⚡ サイト共有（QRコード）</h2>

        <div class="alert alert-success">
            <strong><i class="bi bi-qr-code me-2"></i>QR共有</strong> トップページの緑色のシェアボタンを押すと、共有モーダルに現在ページURLのQRコードが表示されます
        </div>
        <ol>
            <li>トップページ右上の <strong>シェアボタン</strong> をクリック</li>
            <li>モーダル（Modal16）が開き、<strong>QRコード</strong>が自動生成されます</li>
            <li>別端末から読み取って簡単共有できます</li>
        </ol>
        <p><strong>技術情報:</strong> <code>QRCode.js</code> と <code>js/qrcode-generator.js</code> を使用しています。表示されない場合はスクリプト読み込み順やエラーを確認してください。</p>

        <h2 id="section2">2️⃣ 画像を追加する方法</h2>

        <h3>ステップ1：画像管理ページへ移動</h3>
        <ol>
            <li>管理画面のサイドメニューから <strong>「画像」</strong> をクリック</li>
            <li>画像ファイルの一覧が表示されます</li>
        </ol>

        <h3>ステップ2：画像をアップロード</h3>
        <ol>
            <li>ページ上部の <strong>「画像をアップロード」</strong> セクションを探します</li>
            <li>3つのアップロード箇所があります：</li>
        </ol>

        <p><strong>アップロード場所:</strong></p>
        <ul>
            <li><strong>ルート直下</strong> - トップページなど全体に使う画像</li>
            <li><strong>img フォルダ</strong> - 通常の画像ファイル（推奨）</li>
            <li><strong>uploads フォルダ</strong> - ユーザーアップロード画像</li>
        </ul>

        <h3>ステップ3：ファイルを選択</h3>
        <ol>
            <li><strong>「ファイルを選択」</strong> ボタンをクリック</li>
            <li>アップロードしたい画像ファイルを選択</li>
            <li><strong>「アップロード」</strong> ボタンをクリック</li>
        </ol>

        <h3>ステップ4：確認</h3>
        <ol>
            <li>ページ下部の一覧に新しい画像が追加されます</li>
            <li>各画像の詳細情報：</li>
        </ol>
        <ul>
            <li><strong>ファイル名</strong></li>
            <li><strong>ファイルサイズ</strong></li>
            <li><strong>使用箇所</strong> - 実際に使われているか確認</li>
            <li><strong>アクション</strong> - 削除や詳細確認が可能</li>
        </ul>

        <h3>画像を削除する</h3>
        <ol>
            <li>一覧から削除したい画像を探します</li>
            <li>行末の <strong>「削除」</strong> ボタンをクリック</li>
            <li><strong>「本当に削除しますか？」</strong> と確認されるので、確認して削除</li>
        </ol>

        <hr>

        <h2 id="section3">3️⃣ モーダル（ポップアップウィンドウ）を追加する方法</h2>

        <div class="alert alert-info">
            <strong><i class="bi bi-info-circle me-2"></i>重要</strong> 2つの管理ページがあります
        </div>

        <ul>
            <li><strong>A. 通常のチェックリスト管理</strong> で簡単に追加（推奨）</li>
            <li><strong>B. ビジュアルエディタ</strong> で詳細編集</li>
        </ul>

        <h3>方法A：チェックリスト管理からモーダルを追加（簡単）</h3>

        <h4>ステップ1：チェックリスト管理を開く</h4>
        <ul>
            <li>サイドメニューから <strong>「チェックリスト」</strong> をクリック</li>
            <li><strong>「+ 新規追加」</strong> でフォームを開く</li>
        </ul>

        <h4>ステップ2：チェックリストを入力</h4>
        <ol>
            <li>タイトル、カテゴリ、項目を入力</li>
            <li>下にスクロールして、<strong>「モーダルをこのチェックリストに関連付ける」</strong> チェックボックスをONにする</li>
        </ol>

        <h4>ステップ3：モーダルの内容を入力</h4>
        <ol>
            <li><strong>「モーダルタイトル」</strong> - ポップアップのタイトル</li>
            <li><strong>「モーダル内容」</strong> - ポップアップに表示するテキストや画像</li>
        </ol>

        <h4>ステップ4：保存</h4>
        <ul>
            <li><strong>「追加」</strong> をクリック</li>
            <li>ユーザーがメインサイトのチェックリストをクリックすると、このモーダルが表示されます</li>
        </ul>

        <h3>方法B：ビジュアルエディタで詳細編集（上級）</h3>

        <h4>ステップ1：ビジュアルエディタを開く</h4>
        <ul>
            <li>サイドメニューから <strong>「ビジュアルエディタ」</strong> をクリック</li>
        </ul>

        <h4>ステップ2：新規モーダルを追加</h4>
        <ol>
            <li><strong>「+ モーダルを追加」</strong> ボタンをクリック</li>
            <li>モーダルIDと名前を入力</li>
        </ol>

        <h4>ステップ3：内容を編集</h4>
        <ol>
            <li><strong>「タイトルを編集」</strong> - ポップアップのタイトルを入力</li>
            <li><strong>「本文を編集」</strong> - 詳細なHTMLコンテンツを入力可能</li>
            <li>ボタンテキストのカスタマイズも可能</li>
        </ol>

        <h4>ステップ4：プレビュー</h4>
        <ul>
            <li>右側のプレビューパネルでリアルタイム確認</li>
            <li>問題なければ <strong>「保存」</strong> をクリック</li>
        </ul>

        <hr>

        <h2 id="section4">🔄 すべてのコンテンツの同期</h2>

        <ul>
            <li><strong>自動バックアップ</strong> - 毎回の保存時に自動作成</li>
            <li><strong>リアルタイム反映</strong> - 保存後すぐにメインサイトに反映</li>
            <li><strong>復元機能</strong> - 問題が起きた場合、ダッシュボードから復元可能</li>
            <li><strong>バックアップのダウンロード</strong> - 設定ページの一覧からダウンロード可能（<code>admin/download_backup.php</code> 経由）</li>
        </ul>

        <h3>クリアボタン（チェックの初期化）について</h3>
        <ul>
            <li>ローカル保存のうち <code>checkbox_persist_*</code> のみ削除し、他のデータは保持します</li>
            <li>全チェックボックスを未チェックにし、進捗バーを 0% にリセットします</li>
            <li>数十ミリ秒後に自動リロードします（状態の再保存を防ぐため）</li>
        </ul>

        <hr>

        <h2 id="section5">📋 よくある質問</h2>

        <h3>Q1: 画像をアップロードしたのに表示されません</h3>
        <p><strong>A:</strong> 対応フォーマットは <code>.jpg</code>, <code>.jpeg</code>, <code>.png</code>, <code>.gif</code> です<br>
        サイズが大きすぎないか確認してください（推奨: 5MB以下）</p>

        <h3>Q2: チェックリストを修正する方法は？</h3>
        <p><strong>A:</strong> 一覧の 鉛筆ボタン をクリック → フォームが開く → 修正 → 「更新」をクリック</p>

        <h3>Q3: モーダルの中に画像を入れたい</h3>
        <p><strong>A:</strong> ビジュアルエディタで <code>&lt;img&gt;</code> タグを使用できます<br>
        例: <code>&lt;img src="img/sample.jpg" alt="説明" style="width: 100%;"&gt;</code></p>

        <h3>Q4: 誤って削除してしまいました</h3>
        <p><strong>A:</strong> ダッシュボードの <strong>「バックアップから復元」</strong> で以前の状態に戻せます</p>

        <h3>Q5: チェックを入れても進捗バーが更新されません</h3>
        <p><strong>A:</strong> 各セクションの進捗バーに <code>progress-bar0</code>〜<code>progress-bar8</code> のクラスが付与されているか確認してください。<br>
        また、最新版の <code>js/progress_v22.js</code> が読み込まれているか、ブラウザのコンソールエラーをご確認ください。</p>

        <hr>

        <h3>各管理ページへのショートカット</h3>

        <table>
            <thead>
                <tr>
                    <th>機能</th>
                    <th>URL</th>
                    <th>説明</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>画像</td>
                    <td><code>/task/admin/images.php</code></td>
                    <td>画像の追加・削除・使用状況確認</td>
                </tr>
                <tr>
                    <td>ライブエディタ</td>
                    <td><code>/task/admin/live_editor.php</code></td>
                    <td>リアルタイムプレビュー付き編集</td>
                </tr>
                <tr>
                    <td>ダッシュボード</td>
                    <td><code>/task/admin/index.php</code></td>
                    <td>バックアップ・復元、統計表示</td>
                </tr>
                <tr>
                    <td>設定</td>
                    <td><code>/task/admin/settings.php</code></td>
                    <td>バックアップ一覧のダウンロードリンク（安全な配信エンドポイント）</td>
                </tr>
            </tbody>
        </table>

        <hr>

        <h3>💡 ヒント</h3>

        <ul>
            <li>✅ 定期的に <strong>「ダッシュボード」</strong> をチェックして、現在のコンテンツ数を確認しましょう</li>
            <li>✅ 大きな変更の前に <strong>「バックアップから復元」</strong> で事前バックアップを作成</li>
            <li>✅ モーダルの複雑な編集が必要な場合は、ビジュアルエディタより <strong>ライブエディタ</strong> を使うと、プレビューを見ながら編集できます</li>
        </ul>

        <hr>

        <footer class="text-center text-muted mt-5">
            <p><small>更新: 2026年1月9日 | <a href="/task/admin/guide.html">ビジュアルガイドを表示</a></small></p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
